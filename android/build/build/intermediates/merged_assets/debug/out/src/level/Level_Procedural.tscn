[gd_scene load_steps=29 format=2]

[ext_resource path="res://src/player/Ship.tscn" type="PackedScene" id=1]
[ext_resource path="res://src/materials/synth_purple.tres" type="Material" id=2]
[ext_resource path="res://src/level/PathFollow.gd" type="Script" id=3]
[ext_resource path="res://src/level/Level_Procedural.gd" type="Script" id=4]
[ext_resource path="res://src/level/SpawnPoint.gd" type="Script" id=5]
[ext_resource path="res://assets/2d/level/square_purple.png" type="Texture" id=6]
[ext_resource path="res://src/ui/PauseMenu.tscn" type="PackedScene" id=7]
[ext_resource path="res://assets/3d/skybox/horizon.png" type="Texture" id=8]
[ext_resource path="res://src/joypad/joypad.tscn" type="PackedScene" id=10]

[sub_resource type="OpenSimplexNoise" id=1]
octaves = 1
period = 0.1
persistence = 0.0
lacunarity = 0.1

[sub_resource type="OpenSimplexNoise" id=2]
seed = 37
octaves = 1
period = 4.0
persistence = 0.247
lacunarity = 0.1

[sub_resource type="NoiseTexture" id=3]
flags = 1
width = 1
height = 10
noise = SubResource( 2 )

[sub_resource type="Curve3D" id=4]
_data = {
"points": PoolVector3Array( 0, 0.8, -4.9, 0, -0.8, 4.9, 2, -1, -31, 0, 0, 0, 0, 0, 0, 2, -1, 27 ),
"tilts": PoolRealArray( 0, 0 )
}

[sub_resource type="OpenSimplexNoise" id=5]
seed = 3
octaves = 5
period = 16.0

[sub_resource type="SphereMesh" id=6]

[sub_resource type="PanoramaSky" id=7]
panorama = ExtResource( 8 )

[sub_resource type="Environment" id=8]
background_mode = 2
background_sky = SubResource( 7 )
ambient_light_energy = 2.0
ambient_light_sky_contribution = 0.3
tonemap_mode = 1
tonemap_exposure = 1.2
tonemap_white = 8.0
dof_blur_far_distance = 90.0
glow_enabled = true
glow_bloom = 0.15
glow_blend_mode = 0

[sub_resource type="VisualShaderNodeTexture" id=9]
output_port_for_preview = 0
texture = ExtResource( 6 )

[sub_resource type="VisualShaderNodeInput" id=10]
output_port_for_preview = 0
input_name = "uv"

[sub_resource type="VisualShaderNodeVectorOp" id=11]
default_input_values = [ 0, Vector3( 0, 0, 0 ), 1, Vector3( 3, 10, 5 ) ]
operator = 2

[sub_resource type="Gradient" id=12]

[sub_resource type="GradientTexture" id=13]
gradient = SubResource( 12 )

[sub_resource type="VisualShaderNodeTexture" id=14]
texture = SubResource( 13 )
texture_type = 2

[sub_resource type="VisualShaderNodeScalarConstant" id=15]
constant = 0.1

[sub_resource type="VisualShaderNodeScalarConstant" id=16]
constant = 0.2

[sub_resource type="VisualShaderNodeScalarConstant" id=17]
constant = 0.9

[sub_resource type="VisualShader" id=18]
code = "shader_type spatial;
render_mode specular_schlick_ggx;

uniform sampler2D tex_frg_2;
uniform sampler2D tex_frg_5 : hint_normal;



void vertex() {
// Output:0

}

void fragment() {
// Input:3
	vec3 n_out3p0 = vec3(UV, 0.0);

// VectorOp:4
	vec3 n_in4p1 = vec3(3.00000, 10.00000, 5.00000);
	vec3 n_out4p0 = n_out3p0 * n_in4p1;

// Texture:2
	vec4 tex_frg_2_read = texture(tex_frg_2, n_out4p0.xy);
	vec3 n_out2p0 = tex_frg_2_read.rgb;
	float n_out2p1 = tex_frg_2_read.a;

// Scalar:8
	float n_out8p0 = 0.900000;

// Scalar:7
	float n_out7p0 = 0.200000;

// Scalar:6
	float n_out6p0 = 0.100000;

// Texture:5
	vec4 tex_frg_5_read = texture(tex_frg_5, n_out4p0.xy);
	vec3 n_out5p0 = tex_frg_5_read.rgb;
	float n_out5p1 = tex_frg_5_read.a;

// Output:0
	ALBEDO = n_out2p0;
	METALLIC = n_out8p0;
	ROUGHNESS = n_out7p0;
	SPECULAR = n_out6p0;
	EMISSION = n_out2p0;
	NORMALMAP_DEPTH = dot(n_out5p0, vec3(0.333333, 0.333333, 0.333333));

}

void light() {
// Output:0

}
"
graph_offset = Vector2( -87.2, 7.19998 )
nodes/fragment/0/position = Vector2( 600, 60 )
nodes/fragment/2/node = SubResource( 9 )
nodes/fragment/2/position = Vector2( 180, 0 )
nodes/fragment/3/node = SubResource( 10 )
nodes/fragment/3/position = Vector2( -280, 120 )
nodes/fragment/4/node = SubResource( 11 )
nodes/fragment/4/position = Vector2( -60, 120 )
nodes/fragment/5/node = SubResource( 14 )
nodes/fragment/5/position = Vector2( 180, 360 )
nodes/fragment/6/node = SubResource( 15 )
nodes/fragment/6/position = Vector2( 360, 280 )
nodes/fragment/7/node = SubResource( 16 )
nodes/fragment/7/position = Vector2( 360, 200 )
nodes/fragment/8/node = SubResource( 17 )
nodes/fragment/8/position = Vector2( 360, 120 )
nodes/fragment/connections = PoolIntArray( 2, 0, 0, 0, 2, 0, 0, 5, 3, 0, 4, 0, 4, 0, 2, 0, 4, 0, 5, 0, 5, 0, 0, 9, 6, 0, 0, 4, 7, 0, 0, 3, 8, 0, 0, 2 )

[sub_resource type="ShaderMaterial" id=19]
shader = SubResource( 18 )

[node name="Level_Procedural" type="Spatial"]
pause_mode = 1
script = ExtResource( 4 )
points_ahead = 5
points_distance = 200.0
curve_sharp = 0.0
noise_levelgen = SubResource( 1 )

[node name="CanvasLayer" type="Control" parent="."]
pause_mode = 2
anchor_right = 1.0
anchor_bottom = 1.0
__meta__ = {
"_edit_use_anchors_": false
}

[node name="CenterContainer" type="CenterContainer" parent="CanvasLayer"]
anchor_right = 1.0
anchor_bottom = 0.473333
margin_left = 25.0
margin_top = 300.0
margin_right = -24.0
margin_bottom = 300.0
rect_min_size = Vector2( 975, 284 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="joypad" parent="CanvasLayer/CenterContainer" instance=ExtResource( 10 )]
pause_mode = 1
visible = false
anchor_left = 0.0
anchor_top = 0.0
anchor_right = 0.0
anchor_bottom = 0.0
margin_left = 0.0
margin_top = 4.0
margin_right = 975.0
margin_bottom = 279.0
rect_min_size = Vector2( 975, 275 )

[node name="TextureRect" type="TextureRect" parent="CanvasLayer"]
margin_left = 68.0
margin_top = 309.0
margin_right = 103.0
margin_bottom = 434.0
texture = SubResource( 3 )
expand = true
stretch_mode = 6
__meta__ = {
"_edit_use_anchors_": false
}

[node name="PauseMenu" parent="CanvasLayer" instance=ExtResource( 7 )]
pause_mode = 2
visible = false

[node name="Path" type="Path" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 20.9223, 0 )
curve = SubResource( 4 )

[node name="PathFollow" type="PathFollow" parent="Path"]
transform = Transform( 1, 2.21804e-07, 0, -2.21786e-07, 0.999922, 0.0124931, 2.77103e-09, -0.0124932, 0.999917, 2, -1.10693, 19.0753 )
offset = 50.0
rotation_mode = 4
script = ExtResource( 3 )

[node name="Ship" parent="Path/PathFollow" instance=ExtResource( 1 )]
transform = Transform( -1, -5.58794e-09, -3.57628e-07, -3.72529e-09, 1, -1.49012e-08, 2.83122e-07, 4.47035e-08, -1, 0, 0, 0 )
follow_speed = 0.04

[node name="SpawnPoint" type="PathFollow" parent="Path"]
transform = Transform( 1, 1.70691e-07, 1.19653e-06, 0, 0.989978, -0.141223, -1.20865e-06, 0.141224, 0.989975, 2, -20.7996, -33.8245 )
v_offset = -20.0
rotation_mode = 4
script = ExtResource( 5 )
ship_follow_path = NodePath("../PathFollow")
noise = SubResource( 5 )

[node name="RefMesh" type="MeshInstance" parent="Path/SpawnPoint"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 88.6461 )
mesh = SubResource( 6 )
material/0 = null

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource( 8 )

[node name="CSGPolygon" type="CSGPolygon" parent="."]
visible = false
calculate_tangents = false
polygon = PoolVector2Array( 0.977528, 2.96697, 2.83904, 3.00935, 2.58961, 1.5971, 1.05063, 1.51534 )
mode = 2
path_node = NodePath("../Path")
path_interval = 60.0
path_rotation = 2
path_local = false
path_continuous_u = false
path_joined = false
material = ExtResource( 2 )

[node name="CSGPolygon2" type="CSGPolygon" parent="."]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 16.9223, 0 )
calculate_tangents = false
use_collision = true
invert_faces = true
polygon = PoolVector2Array( -100, -16, 100, -16, 100, -20, -100, -20 )
mode = 2
path_node = NodePath("../Path")
path_interval = 60.0
path_rotation = 2
path_local = true
path_continuous_u = false
path_joined = false
material = SubResource( 19 )

[node name="Timer" type="Timer" parent="."]
wait_time = 5.0
autostart = true

[node name="Label" type="Label" parent="."]
anchor_left = 0.019
anchor_top = 0.868
anchor_right = 0.143
anchor_bottom = 0.894
margin_left = -0.407173
margin_top = -0.132507
margin_right = -0.383179
margin_bottom = 0.267517
text = "Teste"
__meta__ = {
"_edit_use_anchors_": false
}

[node name="SideMeshes" type="Spatial" parent="."]

[connection signal="exit_level" from="CanvasLayer/PauseMenu" to="." method="_on_PauseMenu_exit_level"]
[connection signal="pause" from="CanvasLayer/PauseMenu" to="." method="_on_PauseMenu_pause"]
[connection signal="restart_level" from="CanvasLayer/PauseMenu" to="." method="_on_PauseMenu_restart_level"]
[connection signal="unpause" from="CanvasLayer/PauseMenu" to="." method="_on_PauseMenu_unpause"]
[connection signal="player_down" from="Path/PathFollow/Ship" to="." method="_on_Ship_player_down"]
[connection signal="timeout" from="Timer" to="." method="_on_Timer_timeout"]
